% if isinstance(content, list): #no specific content: therefore index


    <form action="" method="get">
    % for knd, lnks in content:
    <p><b><a href="/{{request.lang}}/content?kind={{knd}}">{{knd}}</a></b><br>
       % for linktext,lnklvl,leaf,depth in lnks:
          % if not leaf:
          <small>({{depth}})</small><em><a href="/{{request.lang}}/content?path={{linktext}}">{{linktext}}</a>:</em>
          % else:
             % lnk,lvl = lnklvl
             <small>({{depth}})</small><a href="/{{request.lang}}/content?{{lnk}}">{{linktext}}</a>
             <input type="checkbox" name="choice" value="{{lnk}}" autocomplete="off">
             % try:
             % authorid = lnk.split('.')[0]
             (<a href="/{{request.lang}}/content?link={{authorid}}">{{authorid}}</a>)
             % except: pass
             %end
             <a href="/{{request.lang}}/content?level={{lvl}}">{{lvl}}</a>
          % end
       % end
    % end

    <p><input type="submit" name="compose" value="{{tselected}}"/></p>
    <p>{{texplain}}</p>

    </form>

    <script>
    $("form").on({click:function(ee){
            var e = ee.currentTarget;
            if (e.checked)
                $(this).before($('<input>',{type:"checkbox", name:"choice", value:e.value}));
            else
                e.remove();
            }}, "input[type='checkbox']"
        );
    $("form").on("submit",function(e){
            e.preventDefault();
            var allchecked = $("input[type='checkbox']:checked");
            var a = {};
            for (var ch=0; ch!=allchecked.length; ch++)
            {
                var value = allchecked[ch].value;
                if (a[value] === undefined)
                    a[value]=1;
                else
                    a[value]=a[value]+1;
            }
            document.location.href="/{{request.lang}}/content?"+$.param(a)
        });
    </script>


% else: # specific content

    % if with_problems and not problem.answered:
    <form action="" method="post">
    % end

    % if with_problems and problem.answered and summary[0].counted > 2:
        <p> {{tsummary}}
        {{util.summary(*summary)}}
        </p>
    % end


    {{! content }}


    %qs=query_string
    %is_seq_qs=seq_qs(qs)
    %alinks = ['/'+request.lang+'/content?'+x for x in [start_qs(qs),next_qs(qs,-1),qs,next_qs(qs),end_qs(qs)]]

    %def qsnav(where,sign):
    <button class="grid_1" type="button" onclick="window.location.href='{{ alinks[where] }}';" id="nbutton">{{ sign }}</button>
    %end

    <p>
    % bottonwidth = 'grid_10'
    %if is_seq_qs:
        % bottonwidth = 'grid_6'
        %qsnav(0,'⯈')
        %qsnav(1,'⯇')
    %end

    % if with_problems and problem.answered:
        <button type="button" class="{{bottonwidth}}" onclick="window.location.href='{{ alinks[2] }}';" id="nbutton"> {{tagain}} </button>
    % end
    % if with_problems and not problem.answered:
        <input class="{{bottonwidth}}" style="text-align:center" type="submit" name="submit" id="nbutton" value="{{tcheck}}"/>
        <input type="hidden" name="problemkey" value="{{problemkey}}">
    %end

    %if is_seq_qs:
        %qsnav(3,'⯈')
        %qsnav(4,'⯇')
    %end
    </p>

    % if with_problems and not problem.answered:
    </form>
    % end

    % if not problem.answered and request.user:
        % teacher = request.student.key.parent().parent().get()
        % if teacher.userkey == db.idof(request.user): #self assignment is possible
            <form action="/{{request.lang}}/todo" method="post">
                % fieldset = False
                % for ee in db.assignable(teacher,request.user):
                    % e = ee.key
                    % kind = e.kind()
                    % if kind =='Class':
                        % if fieldset:
                            </fieldset>
                        % end
                        <fieldset>
                        % fieldset = True
                        <input type="hidden" name="query_string" value="{{query_string}}">
                        <div><input type="checkbox" class="checkall">
                            {{util.translate(kind)}} {{e.string_id()}}
                        </div>
                    % elif kind == 'Student':
                        <div><input type="checkbox" name="assignee" value="{{db.urlsafe(e)}}">
                            {{e.string_id()}} </div>
                    % end
                % end
                % if fieldset:
                    </fieldset>
                % end
                <fieldset>
                <script>
                    function subtractduedays(){
                        if(document.getElementById('duedays').value - 1 < 1)
                            return;
                        else
                             document.getElementById('duedays').value--;
                    }
                </script>
                {{tdue}}
                <input type="text" name="duedays" id="duedays" value="2"
                    onchange="javascript:if (document.getElementById('duedays').value >= 1);
                        else document.getElementById('duedays').value = 1;"
                />
                <input type="button" name="add"
                    onclick="javascript: document.getElementById('duedays').value++;" value="+"
                    style="border-radius:0px;border:solid 1px;width:2em;font-weight:bold;background:#EEE"/>
                <input type="button" name="subtract"
                    onclick="javascript: subtractduedays();" value="&mdash;"
                    style="border-radius:0px;border:solid 1px;width:2em;font-weight:bold;background:#EEE"/>
                </fieldset>
                <p><input type="submit" name="assign" value="{{tassign}}"></p>
            </form>

            <script>
            $('.checkall').on('click', function () {
                $(this).closest('fieldset').find(':checkbox').prop('checked', this.checked);
            });
            </script>
        % end
    % end

% end

% include('chcko/main')
